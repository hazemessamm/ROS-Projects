
Building and Rosifying a Robot from Scratch


Unit 1: Building the physical robot
SUMMARY

Estimated time to completion: 2 hour

In this unit, you are going to see step by step how to mount the 2 wheeled robot, using all the materials you have previously ordered.

END OF SUMMARY

So, the very first thing we will need to do in order to rosify a robot, is to actually have a robot. Right? The purpose of this Unit will be to guide you through the process of mounting your own wheeled robot, using all the pieces you have ordered. For further reference, we are going to call our robot the RIAbot. Fancy, right?

It is very important to state that this Notebook is just a GUIDE. There are many ways in which you can assemble all the compoments that will shape your robot. Within this Notebook, we are just showing you the way we did it. So, feel completely free to either follow the same structure as we did, or experiment and change some of the distributions of the robot.

Before starting, let's remember once again all the pieces you will need to have in order to build the complete wheeled robot from scratch:

**Product**	**Purchase Link**
Magician Chassis	https://www.amazon.com/Karlsson-Robotics-SX10825-Magician-Chassis/dp/B007R9U5CU/
Raspberry Pi 3 Model B	https://www.amazon.com/Raspberry-Pi-MS-004-00000024-Model-Board/dp/B01LPLPBS8
16GB Class 10 MicroSD Card	https://www.amazon.com/SanDisk-microSDHC-Standard-Packaging-SDSQUNC-032G-GN6MA/dp/B010Q57T02/
Generic Raspberry Pi Lipo Battery Power Pack Board	https://www.amazon.com/GAOPAN-Lithium-Battery-Expansion-Raspberry/dp/B07QWRN4V6/
Adafruit Powerboost 1000c Board	https://www.amazon.com/Adafruit-PowerBoost-1000-Charger-Rechargeable/dp/B01BMRBTH2/
Lipo Battery for the Powerboost	https://www.amazon.com/1800mAh-battery-Rechargeable-Lithium-Connector/dp/B07BTTKM8H/
Breadboard (1 piece)	https://www.amazon.com/Points-Solderless-Bread-Board-Breadboard/dp/B07JXYBT7N/
Wires	https://www.amazon.com/LANDZO-Multicolored-Breadboard-Raspberry-Arduino/dp/B01IB7UOFE/
H-Bridge L9110 DC/Stepper 2 Way Motor Driver Module	https://www.amazon.com/Super-H-Bridge-Driver-Module-Arduino/dp/B00NN6EB3U/
Arduino UNO Board	https://www.amazon.com/KAILEDI-Development-Microcontroller-ATmega328-ATMEGA16U2/dp/B07V9VGXFS/
Raspberry Pi Camera Module	https://www.amazon.com/Raspberry-Pi-Camera-Module-Megapixel/dp/B01ER2SKFS/
Micro USB Breakout Board	https://www.amazon.com/Adafruit-Micro-B-Breakout-Board-ADA1833/dp/B00KLDPZVU/


Please bear in mind that these purchase links are from Amazon Spain. If you are from any other part of the world, we recommend you to try to find these products from your local resellers. For instance, if you are from the States, it is very likely that you will find all these products in Amazon US (amazon.com).

Bottom Chassis
Grab the Magician Chassis and open it. You will see that it contains 2 main pieces. We'll start mounting the bottom part of the chassis. Grab the bottom part of the chassis, and the motor supports. They are these ones:


Now, let's mount the first of the motors. Pay attention to the following:

You will need to screw it to the motor supports.
Try to keep the motor wires to the inner side of the chassis.
Pay attention to the motor orientation.
You can check the images below for reference:


Let's now also mount the other motor. At the end, you should have something like this:



Now, we recommend you to pass the motor wires to the other side of the chassis. Bear in mind that the side with the motors will be facing the floor. You can check the images below:


Now it's time to add the caster wheel. We will place it on the rear side of the chassis. In the image below you can see where to screw it:



If you haven't done it yet, you can now add the speed board holders to the motors:



And finally, let's also add the wheels. Place them on the plastic axis of the motors, like this:



Great! So we have almost finished mounting the bottom chassis part. Before moving on to the upper chassis, let's do a couple of things more. First, screw the spacers that will connect the bottom part of the chassis with the top part. It will be something like this:



Finally, screw the battery holder on the rear side of the chassis, just above the caster wheel. Check the image below for reference:



Top Chassis
Let's now grab the top part of the chassis. The very first thing we will mount here is the Raspberry LiPo Battery Power Pack Board. Below you can see an example of where we screwed it:





As you can see, this chassis board contains many holes where to screw things up. This means that it offers many different configurations or distributions of all the components. As we already stated at the beginning of the Notebook, it's up to you to decide if you follow our configuration or you prefer to create your own one.

Next, we will add some more spacers, that will hold the base for the Raspberry Pi. We suggest you to don't screw them very hard and leave them with some mobility. When we add the base for the RPi, you will probably need to adjust them a little bit.



Let's now pick the Adafruit Powerboost. Keep in mind that you might need to solder on the USB connector to the board. Once soldered, it looks like this:

NOTE: You might need to solder the USB connector to the board.



We will place behind the RPi PowerPack. Below you can check the up and down view:


Next, we will do the same with the MicroUSB Board. Also, keep in mind that you might need to solder the pins to the board. Once soldered, it should look like this:

NOTE: You might need to solder the pins to the board.



Mount it right below the USB connectors of the RPi PowePack. Check the up and down views:


Let's now add the support for the RPi3, using the spacers we have previously mounted on the chassis. You might need to adjust a little bit the spacers positions in order to fit the RPi3 support. At the end, you should have something like this:



When everything fits correctly, you can now add the RPi3 to the support.



Next, we will use the spacers left in order to build another level on top of the RPi3. So, place the spacers and, on top of the spacers, mount the other plate. You should have something like this:



Now, you can mount on top of the plate the Arduino UNO Board.



Finally, you can add the BreadBoard to the front side of the chassis (you should have some free space there). Peel the sticky film off the bottom of the breadboard and place it there. You should end up with something like this:



Great! So you already have the basic structure of the RIAbot! Now, let's add the sensors and wire up everything!

Connect the sensors and wire up
First, we will connect the Driver for the motors. Grab the piece and connect all the output pins with some male-male jumpers. Have a look at the images below:


Next, we will place a short spacer on top of the bottom chassis.



And on top of the spacer, we will screw the Motor Driver. Like this:



Finally, you will need to connect the motor output wires, to the inputs of the driver. At the end, you should have something like this:



Finally, you can mount the top chassis part. Take into account that all the wires connected to the outputs of the Driver, will need to be connected to the ProtoBoard on top of the top chassis, so you will need to pass them through the chassis. You can now connect them to the Protoboard in the following way:



Note that I have also connected both the Vcc and GND wires. For the rest of the wires, we'll see how to connect them in following Units.

Next step will be to connect the RPi3 camera. For that, you just need to lift up the hold-down tab on the RPi3 camera connector. Now, with the RPi3 camera cable's "metal" side pointing away from the RPi3's USB and Ethernet connectors, slot it into the connector. You should now have something like this:



As you can see from the image above, you can also take the chance to connect the ground wire to the RPi. Place the female end into the lower left pin on the RPi3, as shown in the picture.

We can now proceed to mount everything again. You should have something similar to this:



As you can see, the camera is not placed anywhere. At the moment of building this tutorial, we didn't have any support for the RPi3 camera. So, for now, just try to fix it as best as you can to the front part of the car. Something like this:



In future updates of the Course, we will improve this Notebook and complete some parts that are now missing.

Now we can wire up the Micro-Usb board. Let's take 2 female-male jumpers, and connect them to the Vcc and GND pins.



And, of course, connect the other end of the jumpers to the Protoboard Vcc and GND pins.

Finally, let's also connect the Arduino GND pin to the Protoboard.



So, assuming that you have a Protoboard like the following:



You should have the following connected:

Micro-Usb, RPi3 and Arduino GND pins, should be connected to the the GND pins of the Proboard, which are represented by the (-) symbol.

Vcc pin of the Micro-Usb board should be connected to a Vcc pin of the Protoboard, represented by a (+) symbol.

All the Motor Driver output pins connected to j1 to j6 pins of the Protoboard.

Vcc pin of the Motor Driver (which should be j6), connected to Vcc (+) pin of the Protoboard.

GND pin of the Motor Driver (which should be j5), connected to GND (-) pin of the Protoboard.

Setting up the Camera and all the ROS environment:
We now can work on the RaspBerryPi to have it ready to work with it with ROS. We can divide it into the following steps:

Install Ubuntu Mate in RaspberryPi
Setup Camera in RaspberryPi
Install ROS in RaspberryPi
Install ROS Related packages for the Camera
Install Ubuntu Mate:
This step is optional. You can work in Raspian or in Ubuntu Mate. We reccomend UbuntuMate because it allows you to use standard ubuntu packages as you would in a normal ubuntu distribution.

Download the UbuntuMate Version for RaspberryPi. We recommedn the version RaspberryPi ARMv7: DownloadPage


Burn that image into your microSD card using gnome-disk-utility. To install it just execute this command in your local computer:
sudo apt-get install gnome-disk-utility
Reboot the RaspberryPi with this new image burned and follow the classical Ubuntu configuration. For that you will need to hook up your raspberry pi to a screen through HDMI, connect a mouse and a keyboard.


Setup Camera in RaspberryPi
Now you need to setup your RaspberryPi so that the camera is functional. For that, once you have connected the camera to the RaspberryPi ( explained above ), you will have to do the following:

Install the following inside RaspberryPi:
sudo apt-get install libraspberrypi-dev
sudo pip install picamera
Edit the file /boot/config.txt ** so that these two elemenst are **UNcommented:
start_x=1
gpu_mem=128
Reboot the RaspberryPi:
sudo reboot
To test it That the camera works you will need to install ROS

Install ROS in RaspberryPi
Execute the following commands, but basically are the ofitial command to install ROS-Kinetic in ubuntu:

sudo sh -c 'echo "deb http://packages.ros.org/ros/ubuntu $(lsb_release -sc) main" > /etc/apt/sources.list.d/ros-latest.list'
sudo apt-key adv --keyserver hkp://ha.pool.sks-keyservers.net:80 --recv-key 421C365BD9FF1F717815A3895523BAEEB01FA116
sudo apt-get update
# We dont need the simulation, but need visualization tools
sudo apt-get install ros-kinetic-desktop
sudo rosdep init
rosdep update
echo "source /opt/ros/kinetic/setup.bash" >> ~/.bashrc 
source ~/.bashrc
sudo apt-get install python-rosinstall python-rosinstall-generator python-wstool build-essential
mkdir -p ~/catkin_ws/src
cd ~/catkin_ws/
catkin_make
​
sudo apt-get install ros-kinetic-teleop-twist-keyboard
Please check the offitial instructions in case someting doesnt work: Wiki ROS Instal

Install ROS Related packages for the Camera
Now lets install the packages that we will use to publish camera images in ROS and test them:

sudo apt-get install ros-kinetic-compressed-image-transport
sudo apt-get install ros-kinetic-image-common
sudo apt-get install ros-kinetic-image-view
cd ~/catkin_ws/src
git clone https://github.com/dganbold/raspicam_node.git
cd ~/catkin_ws/
catkin_make --pkg raspicam_node
​
Now lest test. Execute the following inside the RaspberryPi:

Execute in WebShell #1

Start the camera node:

cd ~/catkin_ws/
source devel/setup.bash
roslaunch raspicam_node camera_module_v2_640x480_30fps.launch
​
Execute in WebShell #2

Start the image publishing calling the corresponding service:

# View Image
rosservice call /raspicam_node/start_capture
​
Execute in WebShell #2

Vide the images from the camera through two different methods:

# View Strem
rosrun image_view image_view image:=/raspicam_node/image_raw
rosrun rqt_image_view rqt_image_view


You can have a look at this post explaining it also: Tutorial

You have all this code and more inside the offitial MorpheusChair Create your Robot Tutorials Git: MorpheusChair Git

If you want some video tutorials to know even more, please have a look at: MorpheusChairVideoSeries

